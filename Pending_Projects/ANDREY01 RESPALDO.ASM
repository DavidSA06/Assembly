;RECEPTOR DE INFORMACION RX 
LIST P=16F877A
INCLUDE <P16F877A.INC>
__CONFIG _CP_OFF & _WDT_OFF & _PWRTE_ON & _XT_OSC & _LVP_OFF & _BODEN_OFF

ANS1					EQU					20H								;INICIALIZACION DE VARIABLES
CONSTANTE				EQU					21H
CONSTANTE2				EQU					22H


RESET					ORG					00H								;VECTOR DE RESET
						GOTO				INICIO

INICIO					BSF					STATUS,RP0						;VECTOR DE INICIO
						BCF					STATUS,RP1						;BANCO 1
						MOVLW				B'10000000'
						MOVWF				TRISC
						MOVLW				D'25'							;9600  BAUDIOS
						;MOVLW				D'12'							;19200 BAUDIOS
						MOVWF				SPBRG							;BAUDIOS Fosc/(K*(X+1)) X=SPBRG
						BCF					TXSTA,TX9						;TRANSMISION A 8 BITS
						BCF					TXSTA,SYNC						;USART MODO ASINCRONO 
						BSF					TXSTA,BRGH						;BAUDIOS RATE HIGH SPEED K=16
						BSF					TXSTA,TXEN						;TRANSMISION HABILITADA
						MOVLW				B'10000000'
						MOVWF				OPTION_REG						;PORTB PULL-UP HABILITADO (SOLO PARA PROGRAMAR)
						BCF					STATUS,RP0
						BCF					STATUS,RP1						;BANCO 0
						CLRF				INTCON							;INTERRUPCIONES DESHABILITADOS
						BSF					RCSTA,SPEN						;PUERTO SERIAL HABILITADO
						BCF					RCSTA,RX9						;RECEPCION A 8 BITS
						BSF					RCSTA,CREN						;RECEPCION CONTINUA

RCN						BTFSS				PIR1,RCIF						;BANDERA DE RECEPCION ?
						GOTO				RCN
						BTFSS				PIR1,RCIF
						GOTO				RCN
						MOVF				RCREG,W
						MOVWF				ANS1
						BCF					PIR1,RCIF

						INCF				ANS1,F							;INCREMENTA LA VARIABLE RECIBIDA Y ENVIALA DE NUEVO

						MOVF				ANS1,W
						MOVWF				TXREG
TXN1					BTFSS				PIR1,TXIF						;BANDERA DE TRANSMISION ?
						GOTO				TXN1
						BTFSS				PIR1,TXIF
						GOTO				TXN1
						BCF					PIR1,TXIF
						CLRF				TXREG
					
					
						INCF				ANS1,F

						MOVF				ANS1,W
						MOVWF				TXREG
TXN2					BTFSS				PIR1,TXIF						;BANDERA DE TRANSMISION ?
						GOTO				TXN2
						BTFSS				PIR1,TXIF
						GOTO				TXN2
						BCF					PIR1,TXIF
						CLRF				TXREG
						CLRF				ANS1
						GOTO				RCN
		
		
END
										